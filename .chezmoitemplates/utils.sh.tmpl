#!/bin/bash

# Current host type
CURRENT_HOSTTYPE="{{ .hosttype }}"

check_hosttype() {
    local package_name=$1
    local hosttype=$2

    # If hosttype is empty or not set, install on all environments
    if [ -z "${hosttype}" ] || [ "${hosttype}" = "all" ]; then
        echo "Installing $package_name on $CURRENT_HOSTTYPE environment (all environments)."
        return 0
    fi

    # Convert comma-separated string to array
    IFS=',' read -ra hosttype_array <<< "$hosttype"

    for ht in "${hosttype_array[@]}"; do
        if [[ "$ht" == "$CURRENT_HOSTTYPE" ]]; then
            echo "Installing $package_name on $CURRENT_HOSTTYPE environment."
            return 0
        fi
    done

    echo "Skipping $package_name installation: not applicable for $CURRENT_HOSTTYPE environment."
    return 1
}
