#!/bin/bash

set -e
set -u

# Function to check if a package is installed
is_installed() {
    dpkg -s "$1" >/dev/null 2>&1
}

# Function to install a package if it's not already installed
install_if_needed() {
    local package=$1
    if is_installed "$package"; then
        echo "$package is already installed."
    else
        echo "Installing $package..."
        sudo apt-get install -y "$package"
        echo "$package has been installed successfully."
    fi
}

# Update package lists
echo "Updating package lists..."
sudo apt-get update

# Install packages
{{- range .packages.apt }}
install_if_needed "{{ . }}"
{{- end }}

echo "All tools have been checked and installed if necessary."
